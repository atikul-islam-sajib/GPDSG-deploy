<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Testing - GPDSG</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Testing";
        var mkdocs_page_input_path = "test.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> GPDSG
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data_loader/">DataLoader</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../discriminator/">Discriminator</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../generator/">Generator</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../train/">Trainer</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Testing</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../clf/">Command Line</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">GPDSG</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Testing</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="test"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="test.create_noise_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_noise_data</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">latent_space</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a tensor of random noise data suitable for input to a generative model.</p>
<p>This function creates a tensor of random values with dimensions specified by the function parameters. The tensor is then transferred to the most appropriate device (GPU or CPU) determined by the <code>defined_GPU</code> function.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>batch_size</code></b>
                  (<code>int</code>, default:
                      <code>20</code>
)
              –
              <div class="doc-md-description">
                <p>Number of samples to generate in the batch. Default is 20.</p>
              </div>
            </li>
            <li>
              <b><code>latent_space</code></b>
                  (<code>int</code>, default:
                      <code>100</code>
)
              –
              <div class="doc-md-description">
                <p>Size of the latent space (dimensionality of the noise vector). Default is 100.</p>
              </div>
            </li>
            <li>
              <b><code>image_height</code></b>
                  (<code>int</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Height dimension for each sample in the batch. Default is 1.</p>
              </div>
            </li>
            <li>
              <b><code>image_width</code></b>
                  (<code>int</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Width dimension for each sample in the batch. Default is 1.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
            –
            <div class="doc-md-description">
              <p>torch.Tensor: A tensor of random noise data, shaped (batch_size, latent_space, image_height, image_width) and transferred to the appropriate device.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>noise_data = create_noise_data(20, 100, 1, 1)
print(noise_data.shape)  # Prints torch.Size([20, 100, 1, 1])</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This function is typically used to generate input for generative models like GANs (Generative Adversarial Networks).</li>
<li>The generated noise data serves as a starting point for the generator model to produce synthetic data (such as images).</li>
<li>Ensure that PyTorch is installed and the <code>defined_GPU</code> function is available.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_noise_data</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">latent_space</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a tensor of random noise data suitable for input to a generative model.</span>

<span class="sd">    This function creates a tensor of random values with dimensions specified by the function parameters. The tensor is then transferred to the most appropriate device (GPU or CPU) determined by the `defined_GPU` function.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        batch_size (int): Number of samples to generate in the batch. Default is 20.</span>
<span class="sd">        latent_space (int): Size of the latent space (dimensionality of the noise vector). Default is 100.</span>
<span class="sd">        image_height (int): Height dimension for each sample in the batch. Default is 1.</span>
<span class="sd">        image_width (int): Width dimension for each sample in the batch. Default is 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch.Tensor: A tensor of random noise data, shaped (batch_size, latent_space, image_height, image_width) and transferred to the appropriate device.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; noise_data = create_noise_data(20, 100, 1, 1)</span>
<span class="sd">        &gt;&gt;&gt; print(noise_data.shape)  # Prints torch.Size([20, 100, 1, 1])</span>

<span class="sd">    Note:</span>
<span class="sd">        - This function is typically used to generate input for generative models like GANs (Generative Adversarial Networks).</span>
<span class="sd">        - The generated noise data serves as a starting point for the generator model to produce synthetic data (such as images).</span>
<span class="sd">        - Ensure that PyTorch is installed and the `defined_GPU` function is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">noise_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_space</span><span class="p">,</span> <span class="n">image_height</span><span class="p">,</span> <span class="n">image_width</span><span class="p">)</span>

    <span class="n">device</span> <span class="o">=</span> <span class="n">defined_GPU</span><span class="p">()</span>

    <span class="n">noise_data</span> <span class="o">=</span> <span class="n">noise_data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">noise_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="test.defined_GPU" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">defined_GPU</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determines the best available device for running PyTorch operations.</p>
<p>This function checks if the Metal Performance Shaders (MPS) backend is available for PyTorch on MacOS, which indicates the availability of GPU support. If MPS is available, it sets the device to 'mps' (GPU). Otherwise, it defaults to using the CPU.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
            –
            <div class="doc-md-description">
              <p>torch.device: The determined device (either 'mps' for GPU or 'cpu').</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>device = defined_GPU()
print(device)  # Prints 'mps' if GPU is available, else 'cpu'</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This function is specifically useful for MacOS users with compatible hardware for MPS.</li>
<li>On systems without MPS support or on operating systems other than MacOS, this will default to using the CPU.</li>
<li>Ensure that PyTorch is installed and torch.backends.mps is accessible.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">defined_GPU</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the best available device for running PyTorch operations.</span>

<span class="sd">    This function checks if the Metal Performance Shaders (MPS) backend is available for PyTorch on MacOS, which indicates the availability of GPU support. If MPS is available, it sets the device to &#39;mps&#39; (GPU). Otherwise, it defaults to using the CPU.</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch.device: The determined device (either &#39;mps&#39; for GPU or &#39;cpu&#39;).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; device = defined_GPU()</span>
<span class="sd">        &gt;&gt;&gt; print(device)  # Prints &#39;mps&#39; if GPU is available, else &#39;cpu&#39;</span>

<span class="sd">    Note:</span>
<span class="sd">        - This function is specifically useful for MacOS users with compatible hardware for MPS.</span>
<span class="sd">        - On systems without MPS support or on operating systems other than MacOS, this will default to using the CPU.</span>
<span class="sd">        - Ensure that PyTorch is installed and torch.backends.mps is accessible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;mps&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">device</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="test.display_image" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">display_image</span><span class="p">(</span><span class="n">generated_image</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Displays and saves a grid of generated images.</p>
<p>This function takes a batch of generated images (as tensors) and displays them in a grid format using Matplotlib. Each image in the batch is reshaped to 28x28 dimensions, which is typical for datasets like MNIST. The images are displayed in a figure of size 10x10 inches. Additionally, the grid of images is saved as a PNG file in a specified directory.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>generated_image</code></b>
                  (<code><span title="torch.Tensor">Tensor</span></code>)
              –
              <div class="doc-md-description">
                <p>A batch of images generated by a model, expected as PyTorch tensors.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The function assumes the input tensor is on the GPU and moves it to the CPU before processing.</li>
<li>It reshapes each image in the batch to 28x28. This shape needs to be adjusted if dealing with images of different dimensions.</li>
<li>The function saves the output image grid to './outputs/generated_image.png'. Ensure this directory exists or adjust the path accordingly.</li>
<li>Matplotlib is used for displaying and saving the image, so ensure it is installed in the environment.</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>generated_image = torch.randn(20, 1, 28, 28)  # Example tensor for demonstration
display_image(generated_image)  # Displays and saves the image grid</p>
</blockquote>
</blockquote>
</blockquote>
</details>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>Exception</code>
              –
              <div class="doc-md-description">
                <p>If an error occurs during the display or saving process, it will be logged as an exception.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
          <details class="quote">
            <summary>Source code in <code>test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">display_image</span><span class="p">(</span><span class="n">generated_image</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays and saves a grid of generated images.</span>

<span class="sd">    This function takes a batch of generated images (as tensors) and displays them in a grid format using Matplotlib. Each image in the batch is reshaped to 28x28 dimensions, which is typical for datasets like MNIST. The images are displayed in a figure of size 10x10 inches. Additionally, the grid of images is saved as a PNG file in a specified directory.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        generated_image (torch.Tensor): A batch of images generated by a model, expected as PyTorch tensors.</span>

<span class="sd">    Note:</span>
<span class="sd">        - The function assumes the input tensor is on the GPU and moves it to the CPU before processing.</span>
<span class="sd">        - It reshapes each image in the batch to 28x28. This shape needs to be adjusted if dealing with images of different dimensions.</span>
<span class="sd">        - The function saves the output image grid to &#39;./outputs/generated_image.png&#39;. Ensure this directory exists or adjust the path accordingly.</span>
<span class="sd">        - Matplotlib is used for displaying and saving the image, so ensure it is installed in the environment.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; generated_image = torch.randn(20, 1, 28, 28)  # Example tensor for demonstration</span>
<span class="sd">        &gt;&gt;&gt; display_image(generated_image)  # Displays and saves the image grid</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs during the display or saving process, it will be logged as an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">generated_image</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;./outputs/generated_image.png&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="test.get_best_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_best_model</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves the path to the best (most recent) model checkpoint from a specified directory.</p>
<p>This function scans the checkpoint directory for model files and selects the one that is assumed to be the most recent based on its naming convention. The function assumes that the model files are named or numbered in such a way that the last one in the directory is the best model.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>str</code></b>            –
            <div class="doc-md-description">
              <p>The file path of the best model checkpoint.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>FileNotFoundError</code>
              –
              <div class="doc-md-description">
                <p>If the checkpoint directory does not exist or is empty.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>best_model_path = get_best_model()
print(best_model_path)  # Displays the path of the most recent model checkpoint</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The function uses the 'os' library to interact with the file system.</li>
<li>The checkpoint directory path is hardcoded as './models/checkpoints/'.</li>
<li>It is assumed that the model files are stored as separate files within this directory.</li>
<li>Ensure that the naming convention of the model files reflects their chronological order.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_best_model</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the path to the best (most recent) model checkpoint from a specified directory.</span>

<span class="sd">    This function scans the checkpoint directory for model files and selects the one that is assumed to be the most recent based on its naming convention. The function assumes that the model files are named or numbered in such a way that the last one in the directory is the best model.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The file path of the best model checkpoint.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the checkpoint directory does not exist or is empty.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; best_model_path = get_best_model()</span>
<span class="sd">        &gt;&gt;&gt; print(best_model_path)  # Displays the path of the most recent model checkpoint</span>

<span class="sd">    Note:</span>
<span class="sd">        - The function uses the &#39;os&#39; library to interact with the file system.</span>
<span class="sd">        - The checkpoint directory path is hardcoded as &#39;./models/checkpoints/&#39;.</span>
<span class="sd">        - It is assumed that the model files are stored as separate files within this directory.</span>
<span class="sd">        - Ensure that the naming convention of the model files reflects their chronological order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">checkpoint_path</span> <span class="o">=</span> <span class="s2">&quot;./models/checkpoints&quot;</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">checkpoint_path</span>
        <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="o">+</span> <span class="s2">&quot;generator_&quot;</span>
        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;.pth&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">best_model</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="test.test_DCGAN" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">test_DCGAN</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Tests a Deep Convolutional Generative Adversarial Network (DCGAN) by generating images.</p>
<p>This function automates the process of loading the best model checkpoint for the DCGAN's generator, generating a batch of noise data, and using the generator to produce images from this data. It then attempts to display these generated images using the <code>display_image</code> function.</p>
<p>Steps:
1. Loads the best model checkpoint using the <code>get_best_model</code> function.
2. Sets up the device (GPU or CPU) for running the model.
3. Initializes the Generator model and loads the checkpoint.
4. Generates noise data and feeds it to the Generator to produce images.
5. Displays the generated images using <code>display_image</code>.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>Exception</code>
              –
              <div class="doc-md-description">
                <p>Logs any exceptions that occur during the image generation or display process.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>test_DCGAN()  # This will run the DCGAN test and display generated images</p>
</blockquote>
</blockquote>
</blockquote>
</details>
<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The function assumes the presence of a <code>Generator</code> class and its corresponding pre-trained model checkpoint.</li>
<li>It also assumes that the <code>display_image</code> function is defined and can accept the generated images.</li>
<li>Any exceptions raised during the process are caught and logged for debugging purposes.</li>
<li>The function uses global logging settings to log messages and exceptions.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test_DCGAN</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests a Deep Convolutional Generative Adversarial Network (DCGAN) by generating images.</span>

<span class="sd">    This function automates the process of loading the best model checkpoint for the DCGAN&#39;s generator, generating a batch of noise data, and using the generator to produce images from this data. It then attempts to display these generated images using the `display_image` function.</span>

<span class="sd">    Steps:</span>
<span class="sd">    1. Loads the best model checkpoint using the `get_best_model` function.</span>
<span class="sd">    2. Sets up the device (GPU or CPU) for running the model.</span>
<span class="sd">    3. Initializes the Generator model and loads the checkpoint.</span>
<span class="sd">    4. Generates noise data and feeds it to the Generator to produce images.</span>
<span class="sd">    5. Displays the generated images using `display_image`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: Logs any exceptions that occur during the image generation or display process.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; test_DCGAN()  # This will run the DCGAN test and display generated images</span>

<span class="sd">    Note:</span>
<span class="sd">        - The function assumes the presence of a `Generator` class and its corresponding pre-trained model checkpoint.</span>
<span class="sd">        - It also assumes that the `display_image` function is defined and can accept the generated images.</span>
<span class="sd">        - Any exceptions raised during the process are caught and logged for debugging purposes.</span>
<span class="sd">        - The function uses global logging settings to log messages and exceptions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">get_best_model</span><span class="p">()</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">defined_GPU</span><span class="p">()</span>

    <span class="n">generator</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">generator</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>

    <span class="n">generated_image</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="n">create_noise_data</span><span class="p">())</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">display_image</span><span class="p">(</span><span class="n">generated_image</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Generated image is not defined&quot;</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../train/" class="btn btn-neutral float-left" title="Trainer"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../clf/" class="btn btn-neutral float-right" title="Command Line">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../train/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../clf/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
